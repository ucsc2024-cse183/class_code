# if have podman use it instead of docker, it is better
which podman && cmd=podman || cmd=docker
#$cmd build . -t selenium -f Dockerfile && $cmd run -it --mount type=bind,source=$(dirname $1),target=/repo selenium sh -c "git clone https://github.com/ucsc2024-cse183/class_code.git && venv/bin/python class_code/grader/grade.py --override=/repo/$(basename $1)"
$cmd build . -t selenium -f Dockerfile && $cmd run -it --mount type=bind,source=$(dirname $1),target=/repo selenium sh -c "git init class_code && cd class_code && git remote add origin https://github.com/ucsc2024-cse183/class_code.git && git config core.sparsecheckout true && (echo 'grader/' >> .git/info/sparse-checkout) && git pull --depth=1 origin main && ls -l && cd .. && venv/bin/python class_code/grader/grade.py --override=/repo/$(basename $1)"
